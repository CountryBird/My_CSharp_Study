# 대리자란?
대리자는 개체에 대한 참조를 저장하는 방법과 비슷하게, 메서드에 대한 참조를 저장하는 방법으로 사용됩니다.    
메서드에 개체를 전달할 수 있는 것처럼 대리자를 사용하여 메서드 참조를 전달할 수 있습니다.      
이 기능을 통해 다양한 메서드를 **연결** 하여 다른 동작을 제공하는 유연한 코드를 작성할 수 있습니다.    

# 대리자 타입 정의
`delegate` 키워드를 통해 대리자 타입을 만들 수 있습니다.     

```cs
public delegate int Calculator(int x, int y);
```
이 `Calculator` 대리자는 2개의 `int` 파라미터를 받고 `int`를 반환하는    
모든 메서드에 대한 참조를 보유할 수 있습니다.    

```cs
public delegate int Comparison<in T>(T left, T right);
```
이 `Comparison`은 조금 더 실용적인 예제로,    
`T`를 통해 동적으로 2개의 파라미터의 타입을 결정할 수 있는 형태입니다.   

이와 같이 대리자 타입을 정의하면, 컴파일러는 `System.Delegate`에서 파생된 클래스를 자동으로 생성합니다.    
해당 클래스가 메서드 참조, 저장, 호출에 대한 복잡한 작업을 처리하기 때문에, 개발자는 작은 작업으로 대리자 작업을 사용할 수 있습니다.   

단순히 변수를 선언하는 수준으로만 보이지만, 실제로는 아예 새로운 타입을 선언하는 것입니다.     
컴파일러는 이 새로운 타입에 대한 추가/제거 처리기를 자체적으로 생성합니다.   


# 대리자의 인스턴스 선언
대리자 타입을 정의한 후 해당 형식의 인스턴스를 만들 수 있습니다.   
메서드에 대한 참조를 위한 **_슬롯_** 의 개념으로 생각하면 편합니다.   

C#의 모든 변수와 마찬가지로 네임스페이스 또는 전역 네임스페이스에서 직접 대리자 인스턴스를 선언할 수는 없습니다.   
```cs
public Comparison<T> comparator;
```
이 변수는, `Comparison<T>` 타입이 변수의 이름입니다.   
이전이 정의를 하는 코드였다면, 해당 코드는 실제 객체 슬롯을 만든 것이고     
아직 메서드가 지정되지 않았기 때문에 해당 상태로는 사용할 수 없습니다.    

# 대리자 호출
메서드를 가리키는 대리자 인스턴스가 있으면,   
대리자를 통해 그 메서드를 호출할 수 있습니다.    

대리자 자체를 메서드 호출하듯이 호출하여 대리자 호출 목록에 있는 메서드를 실행합니다.   

```cs
int result = comparator(left, right);
```
해당 코드는 대리자에 연결된 메서드를 호출할 수 있습니다.    

단, 이 코드 줄은 안전하지 않을 수 있습니다.    
메서드가 연결되지 않은 경우 `NullReferenceExcption`가 발생할 수 있습니다.   

# 호출 대상 할당, 추가 및 제거
대리자를 사용하기 위해서는 메서드를 할당해야 합니다.      
할당하는 메서드는 정의된 대리자와 같은 타입을 사용해야 합니다.   

```cs
private static int CompareLength(string left, string right)
=> left.Length.CompareTo(right.Length);
```
위와 같은 형식으로 메서드를 정의할 수 있습니다.      
이는 다른 메서드 선언과 크게 다를 바가 없으며, 실제로 정적 메서드를 선언하는 코드입니다.   

```cs
phrases.Sort(CompareLength);
```
선언된 메서드에 대해 괄호를 사용하지 않는 방법을 통해
**메서드를 참조하여 사용할 수 있습니다.**       
이는 해당 메서드를 델리게이트로 받아 사용함을 의미합니다.    

```cs
Comparison<string> comparer = CompareLength;
phrases.Sort(comparer);
```
위의 코드를 통해서도 델리게이트로 사용할 수 있습니다.    
이전의 코드와 비교하였을 때, 덜 간결하지만 명확하게 델리게이트를 선언할 수 있습니다.

```cs
Comparison<string> comparer = (left, right) => left.Length.CompareTo(right.Length);
phrases.Sort(comparer);
```
코드가 복잡하지 않은 경우 람다 식을 사용해 대리자를 사용할 수 있습니다.    

# Delegate 및 MulticastDelegate 클래스
